<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		
		<record id="view_credit_request_search" model="ir.ui.view">
            <field name="name">credit.request.search</field>
            <field name="model">credit.request</field>
            <field name="arch" type="xml">
                <search string="Credit Requests">
                    <!-- Filters -->
                    <field name="partner_id" string="Customer"/>
                    <field name="sale_id" string="Sale Order Reference"/>

                    <!-- Group by options -->
                    <group>
                        <filter name="group_by_partner" string="Customer" domain="[]" context="{'group_by': 'partner_id'}"/>
                        <filter name="group_by_sale" string="Sale Order" domain="[]" context="{'group_by': 'sale_id'}"/>
                        <filter name="group_by_state" string="Status" domain="[]" context="{'group_by': 'state'}"/>
                        <filter name="group_by_date" string="Request Date" domain="[]" context="{'group_by': 'create_date'}"/>
                    </group>
                </search>
            </field>
        </record>

		<record id="tree_credit_request_view" model="ir.ui.view">
			<field name="name">credit.request.list</field>
			<field name="model">credit.request</field>
			<field name="arch" type="xml">
				<list default_order='create_date desc' create="0" delete="0" edit="1">
					<field name="name"/>
					<field name="create_date" string="Request Date"/>
					<field name="partner_id"/>
					<field name="amount"/>
					<field name="sale_id"/>
					<field name="requested_user_id"/>
					<field name="state"/>
					<field name="request_type"/>
					<button name="action_open_sale_order" class="btn btn-primary" string="View Sale Order" type="object"/>
					<button name="action_approve" class="btn btn-primary" string="Approve" type="object" groups="sp_sales_approval.group_sales_approval" invisible="state != 'pending'"/>
					<button name="action_reject" class="btn btn-secondary" string="Reject" type="object" groups="sp_sales_approval.group_sales_approval" invisible="state != 'pending'"/>
				</list>
			</field>
		</record>

		<record id="action_credit_request" model="ir.actions.act_window">
			<field name="name">Sales Credit Request</field>
			<field name="res_model">credit.request</field>
			<field name="domain">[('request_type','=','credit')]</field>
			<field name="search_view_id" ref="view_credit_request_search"/>
			<field name="view_mode">list</field>
		</record>

		<record id="action_advance_payment_request" model="ir.actions.act_window">
			<field name="name">Advance Payment Request</field>
			<field name="res_model">credit.request</field>
			<field name="domain">[('request_type','=','advance')]</field>
			<field name="search_view_id" ref="view_credit_request_search"/>
			<field name="view_mode">list</field>
		</record>

		<menuitem id="menu_credit_request" name="Credit Request" web_icon="sp_sales_approval,static/img/credit_icon.png" groups="sales_team.group_sale_salesman" />
		<menuitem id="submenu_credit_request" name="Sales Credit Request" action="action_credit_request" parent="sp_sales_approval.menu_credit_request" sequence="2"/>
		<menuitem id="submenu_advance_payment_request" name="Advance Payment Request" action="action_advance_payment_request" parent="sp_sales_approval.menu_advance_payment"/>

	</data>
</odoo>